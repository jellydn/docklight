# Ralph Progress Log
Started: Fri Feb 27 21:01:07 +08 2026
---

## [Fri Feb 27 2026] - US-001
[Session: https://opncd.ai/s/]
- Implemented backend scaffold with Express, TypeScript, and shell executor
- Created server/ directory with package.json, tsconfig.json
- Implemented shell executor at server/lib/executor.ts with 30s timeout
- Created command allowlist at server/lib/allowlist.ts
- Set up Express server at server/index.ts with /api/health endpoint
- Typecheck passes
- Files changed: server/package.json, server/tsconfig.json, server/lib/allowlist.ts, server/lib/executor.ts, server/index.ts, server/.gitignore
- **Learnings for future iterations:**
  - Used Bun for package installation and running scripts
  - TypeScript configured with ES2022 target and commonjs module for Node.js
  - Command executor uses promisify(exec) for async/await pattern
---

## [Fri Feb 27 2026] - US-002
[Session: https://opncd.ai/s/]
- Implemented SQLite command history persistence with better-sqlite3
- Created server/lib/db.ts with DB initialization at data/docklight.db
- Created command_history table with id, command, exitCode, stdout, stderr, createdAt
- Implemented saveCommand() and getRecentCommands(limit) functions
- Updated executor.ts to auto-save every execution to DB
- Added GET /api/commands endpoint returning last 20 commands
- Typecheck passes
- Files changed: server/lib/db.ts, server/lib/executor.ts, server/index.ts, server/package.json, server/tsconfig.json
- **Learnings for future iterations:**
  - better-sqlite3 requires @types/better-sqlite3 for TypeScript support
  - DB stored in ../data/ relative to server/ directory
  - Command executor now always saves to DB, regardless of success/failure
---

## [Fri Feb 27 2026] - US-003
[Session: https://opncd.ai/s/]
- Implemented authentication backend with JWT and cookie sessions
- Installed jsonwebtoken and cookie-parser dependencies
- Created server/lib/auth.ts with login, verifyToken, generateToken, setAuthCookie, clearAuthCookie, and authMiddleware
- Added POST /api/auth/login endpoint accepting { password }
- Added POST /api/auth/logout endpoint clearing session cookie
- Added GET /api/auth/me endpoint returning { authenticated: true } if valid session
- Applied authMiddleware to all /api/* routes except /api/auth/login and /api/health
- JWT secret from DOCKLIGHT_SECRET env var or default (production warning)
- Password read from DOCKLIGHT_PASSWORD env var
- Typecheck passes
- Files changed: server/lib/auth.ts, server/index.ts, server/package.json, server/tsconfig.json
- **Learnings for future iterations:**
  - authMiddleware applied after specific routes to exclude them from protection
  - httpOnly cookie prevents XSS attacks on session token
  - Cookie configured with secure flag in production environment
---

## [Fri Feb 27 2026] - US-004
[Session: https://opncd.ai/s/]
- Created frontend scaffold with React + Vite + TypeScript
- Installed and configured Tailwind CSS v3
- Installed react-router-dom for routing
- Created AppLayout component with left sidebar (Dashboard, Apps, Databases links) and main content area
- Set up routes: /login, /dashboard, /apps, /apps/:name, /databases
- Created API client utility at client/src/lib/api.ts with fetch wrapper that handles auth (redirects to /login on 401)
- Configured Vite proxy to forward /api/* to backend (http://localhost:3001) in development
- Created placeholder pages for all routes
- Added typecheck script to package.json
- Typecheck passes
- Files changed: client/package.json, client/tsconfig.json, client/vite.config.ts, client/tailwind.config.js, client/postcss.config.js, client/src/index.css, client/src/App.tsx, client/src/components/AppLayout.tsx, client/src/lib/api.ts, client/src/pages/*.tsx
- **Learnings for future iterations:**
  - Tailwind CSS v3 requires specifying content paths in config
  - Vite proxy configured to forward /api/* to backend during development
  - API client uses credentials: 'include' to send cookies with requests
  - React Router uses <Outlet /> for nested route rendering in AppLayout
---

## [Fri Feb 27 2026] - US-005
[Session: https://opncd.ai/s/]
- Implemented login page UI with form handling and error display
- Added password input field and submit button to Login page
- Implemented form submission calling POST /api/auth/login with entered password
- On successful login, redirects to /dashboard
- On failure, displays error message 'Invalid password'
- Added authentication check on mount - if already authenticated (GET /api/auth/me returns 200), redirects to /dashboard
- Added logout button in sidebar calling POST /api/auth/logout and redirecting to /login
- Typecheck passes
- Browser verification skipped due to ChromeDevTools MCP not configured
- Files changed: client/src/pages/Login.tsx, client/src/components/AppLayout.tsx
- **Learnings for future iterations:**
  - Login component checks /api/auth/me on mount to redirect authenticated users
  - Logout button uses onClick handler instead of Link for POST request
  - Form uses React controlled component pattern for password state
---
